import{r as p,e as x,a0 as _,j as s,P as j,f as y,g,h as N,u as E,s as f,a1 as O,N as v}from"./index-4eddcbba.js";import{e as D,S as b,f as F,M as C}from"./Modal-55d8fc81.js";import"./CloseButton-9cc44bcb.js";const L=({order:e,closeFn:d})=>{const[i,r]=p.useState({id:e.id,shipping_id:e.Shipping[0].id,payment_status:e.order_status,shipping_status:e.Shipping[0].status}),n=x(),u=["PENDING","PAID","CANCELLED"],l=["INPROGRESS","SHIPPED","DELIVERED"],c=a=>{r({...i,[a.target.name]:a.target.value})},[h,{isLoading:o,isError:t}]=_(),m=async a=>{if(a.preventDefault(),i.shipping_id===e.Shipping[0].status&&i.payment_status===e.order_status){n(y("Update order status"));return}try{await h(i).unwrap(),r({id:e.id,shipping_id:e.Shipping[0].id,payment_status:e.order_status,shipping_status:e.Shipping[0].id}),d(),n(g("Order updated successfully"))}catch(S){n(N(S.message))}};return o?s.jsx("div",{className:"product-container",children:s.jsx("h1",{children:"Loading..."})}):t?s.jsxs("div",{className:"product-container",children:[s.jsx(CloseButton,{closeFn:d}),s.jsx("h1",{children:"Error updating product."})]}):s.jsxs("div",{className:"update-order",children:[s.jsx("h3",{children:"Order Update"}),s.jsxs("form",{onSubmit:m,children:[s.jsxs("label",{htmlFor:"shipping_status",children:["Shipping Status",s.jsx("select",{name:"shipping_status",id:"shipping_status",value:i.shipping_status,onChange:c,children:l.map(a=>s.jsx("option",{value:a,children:a},a))})]}),s.jsxs("label",{htmlFor:"payment_status",children:["Payment Status",s.jsx("select",{name:"payment_status",id:"payment_status",value:i.payment_status,onChange:c,children:u.map(a=>s.jsx("option",{value:a,children:a},a))})]}),s.jsx(j,{children:"Update"})]})]})},R=()=>{var o;const e=(o=E(f).data)==null?void 0:o.orders,[d,i]=p.useState(!1),[r,n]=p.useState({}),[u]=O(),l=x(),c=t=>{i(!0),n(t)},h=async t=>{try{await u(t.id).unwrap(),l(g("Order deleted successfully"))}catch(m){l(N(m.message))}};return p.useEffect(()=>{document.title="Orders List"}),s.jsxs(s.Fragment,{children:[s.jsxs("ul",{className:"admin-orders-title",children:[s.jsx("li",{className:"order-id",children:"id"}),s.jsx("li",{className:"order-address",children:"address"}),s.jsx("li",{className:"order-tn",children:"tracking number"}),s.jsx("li",{className:"order-status",children:"status"}),s.jsx("li",{className:"order-total",children:"total"}),s.jsx("li",{className:"order-actions",children:"actions"})]}),s.jsx("ul",{className:"admin-orders-body",children:e.length?e==null?void 0:e.map(t=>s.jsxs("li",{className:"order-list",children:[s.jsx("div",{className:"order-id ",children:s.jsx(v,{to:`/orders/${t.id}`,children:t.id})}),s.jsx("p",{className:"order-address ",children:t.Shipping[0].address}),s.jsx("p",{className:"order-track ",children:t.Shipping[0].tracking_number}),s.jsx("p",{className:`order-status ${t.order_status.toLowerCase()}`,children:t.order_status}),s.jsxs("p",{className:"order-total ",children:["$",t.total_amount]}),s.jsxs("div",{className:"buttons",children:[s.jsx(j,{buttonFn:()=>c(t),children:s.jsx(D,{})}),s.jsx(b,{buttonFn:()=>h(t),children:s.jsx(F,{})})]})]},t==null?void 0:t.id)):s.jsx("p",{children:"No orders to display"})}),d&&s.jsx(C,{isOpen:r,onClose:()=>i(!1),children:s.jsx(L,{order:r,closeFn:()=>i(!1)})})]})};export{R as default};
